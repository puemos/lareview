# Code Review is Stuck. Let's Reimagine It.

For years, the way we review code has been stuck. We've been using the same basic tool: a simple, file-by-file diff with a thread-like system for async conversations. It was a fine start, but it hasn't fundamentally changed.

Lately, we've added suggestions, integrations, and more notifications. Useful, but still incremental. In a lot of cases it's just more layers on top of a dated foundation.

The core problem remains: a flat list of file changes doesn't represent how we think about code. A feature isn't just a collection of edits, it's a logical flow with a clear purpose.

AI can help, but the bigger point is: the current workflow still isn't the best we can do. We should keep innovating on review.

## LaReview: A New DX for Code Review

LaReview is built on the idea that a review shouldn't be a passive scroll through a diff, but an active process of verifying a change's intent.

We do this by structuring every review around **Intents** and **Sub-flows**:

1. **Intent:** the high-level goal. What is this PR really trying to achieve? (e.g., "Implement password reset flow")
2. **Sub-flows:** the concrete, verifiable steps required to make the intent real (e.g., "Generate token", "Send email", "Validate token", "Allow password update")

This gives you a checklist that matches how code works. You're no longer just reviewing lines; you're validating a story.

## How it works

LaReview is a mini-app with two steps:

1. **Generate** a plan from a diff (or PR)
2. **Review** task-by-task and track progress

Input:
- Paste a unified diff, or paste a GitHub PR (`owner/repo#123` or a PR URL)

Under the hood (no new engines, no custom auth):
- GitHub PR metadata + diff are fetched locally via `gh`
- The plan is generated by an AI agent you run, via the [Agent Client Protocol (ACP)](https://agentclientprotocol.com/overview/introduction)

## Design goals

- **DX**: review flows, not file lists
- **Local-first state**: tasks, notes, and status are stored in a local SQLite DB
- **Security / trust model**: no LaReview server in the middle; processing happens through the tools you already use (`gh` + your ACP agent)
- **Fits your setup**: use ACP instead of a new agent runtime; use `gh` instead of forcing new integrations

## A New UI for a New DX

LaReview has two main views: `GENERATE` and `REVIEW`.

### GENERATE

Paste a diff (or PR), pick an agent, and generate a plan. While the agent runs, you get a timeline of what’s happening.

### REVIEW

The review plan is shown as a tree: Intent → Sub-flows → Tasks. Selecting a task shows its details plus a unified diff viewer for the related hunks. Add notes, and mark tasks as **To Do**, **In Progress**, **Done**, or **Ignored**.

Use **Clean done** to remove completed tasks (and their notes) for the current review.

### Data model (what’s stored locally)

- **Review:** a saved review (diff paste or GitHub PR)
- **ReviewRun:** one generation run (diff + agent output)
- **ReviewTask:** a single task in the plan (with diffs, insight, status, optional diagram)
- **Note:** your notes, optionally tied to a file + line

## Getting started (from source)

1. Run: `cargo run`
2. In `GENERATE`, paste a unified diff or a GitHub PR like `owner/repo#123` (or a PR URL)
3. Pick an agent and generate a plan

If you want to load PRs, you need `gh` installed + authenticated:
- Install: `brew install gh`
- Auth: `gh auth login`

## Data + paths

- DB: `.lareview/db.sqlite` (in the current working directory)
- Logs (ACP/MCP): `.lareview/logs/`
- Override DB path: `LAREVIEW_DB_PATH=/path/to/db.sqlite`

## Development quickstart

- Toolchain: nightly Rust with `rustfmt` and `clippy` components (edition 2024; see `rust-toolchain.toml`).
- OS deps (Linux): `libxkbcommon-dev`, `libxkbcommon-x11-dev`.
- Run the app: `cargo run`
- Reset/seed sample data: `cargo run --bin reset_db`, `cargo run --bin seed_db`
- Checks: `cargo fmt -- --check`, `cargo clippy --all-targets --all-features -- -D warnings`, `cargo test`
- Supply chain: `cargo deny check` (used in scheduled CI) to catch license/advisory issues.
- Docs index: [docs/README.md](docs/README.md)
- Architecture overview: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)
- Development guide: [docs/DEVELOPMENT.md](docs/DEVELOPMENT.md)

## Project metadata

- License: MIT (see `LICENSE`)
- Code of Conduct: `CODE_OF_CONDUCT.md`
- Contributing guide: `CONTRIBUTING.md`
- Security policy: `SECURITY.md`
